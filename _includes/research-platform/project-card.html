{% comment %}
Expects following parameters:
    project
        .url
        .name
        .deadline
        .contact
        .leader
        .lab_name
        .positions
        .content
        .funding
        .location
        .weekly_hours
        .education_level
        .remote
    make_collapsable
{% endcomment %}
{% assign project = include.project %}
{% assign make_collapsable = include.make_collapsable | default: false %}
{% assign lab = site.labs | where: 'short_name', project.lab_name | first %}
{% if lab == nil %}
{% assign lab = site.labs | where: 'name', project.lab_name | first %}
{% endif %}

<div class="">
    <div class="card row">
        <div class="project-card-header" id="heading{{forloop.index}}">
            {% if make_collapsable == true %}
            <button 
                data-toggle="collapse" 
                data-target="#collapse{{forloop.index}}" 
                aria-expanded="true"
                aria-controls="collapse{{forloop.index}}" 
                style="text-align: left; background: transparent; outline: 0; border: 0px;"
            >
            {% endif %}
            <div class="col-lg-9 col-md-9 col-sm-12">
                <h3>
                    {% if project.url %}
                    <a href="{{ project.url | relative_url }}">{{ project.name }}</a>
                    {% else %}
                    {{ project.name }}
                    {% endif %}
                </h3>
                <p class="project-info">
                    {% if project.created %}
                    <b>Created/Updated: </b>{{ project.created }},
                    {% endif %}
                    <b>Deadline: </b>{{ project.deadline }}
                </p>
    
                <p class="project-info">
                {% if project.positions %}
                <b>Positions:</b>
                {% for position in project.positions %}
                <span class="comma">{{ position.name }}</span>
                {% endfor %}
                {% endif %}
                </p>
            </div>
            <div class="col-lg-3 col-md-3 hidden-xs hidden-sm" style="text-align: right">
                {% if lab %}
                    <a href="{{ lab.url | relative_url }}">
                    {% if lab.logo %}
                    <img src="{{ lab.logo | relative_url }}" alt="{{lab.name}} logo" class="width-100 width-max-100px">
                    {% else %}
                    <h4><i class="fa-solid fa-flask"></i> {{ lab.name }} </h4>
                    {% endif %}
                    </a>
                {% else %}
                    <h4><i class="fa-solid fa-flask"></i> {{ project.lab_name }} </h4>
                {% endif %}
            </div>

            <p class="project-info col-sm-12">
                <span class="project-property"><i class="fa-solid fa-location-dot"></i> Location: {{project.location}}{% if project.remote %} / remote {% endif %}</span>
                {% if project.funding %}
                <span class="project-property"><i class="fa-solid fa-wallet"></i> Funding: {{project.funding }}</span>
                {% endif %}
                {% if project.weekly_hours %}
                <span class="project-property"><i class="fa-solid fa-clock"></i> Weekly commitement: {{project.weekly_hours }}h </span>
                {% endif %}
                {% if project.education_level %}
                <span class="project-property"><i class="fa-solid fa-user-graduate"></i> Education level: {{ project.education_level }} </span>
                {% endif %}
            </p>
            
            {% if make_collapsable == true %}
            </button>
            {% endif %}
        </div>
        <div id="collapse{{forloop.index}}" class="collapse show" aria-labelledby="heading{{forloop.index}}" style="height: 0px;" data-parent="#accordion">
            <div class="project-card-content">
                {{ project.content | markdownify }}
                <p><i class="fa-solid fa-address-book"></i> Contact: {{ project.leader }} ({{ project.contact | replace: "@", " [ at ] " }})</p>
                <a href="{{project.url}}" class="btn btn-default btn-lg"><i class="fa-solid fa-file"></i> See project page</a>
            </div>
        </div>
    </div>
</div>